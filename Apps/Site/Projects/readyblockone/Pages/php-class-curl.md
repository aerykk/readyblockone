<div class="post-805 post type-post status-publish format-standard hentry category-programming tag-class tag-curl tag-php row-fluid blog-post" id="post-805">
    <div class="nav span2">
        <ul class="well nav-list">
            <li class="author">
                <i class="icon-user icon-black"></i> By: <a href="/author/eric/" title="Posts by Eric Muyser" rel="author" address="true">Eric Muyser</a> </li>
            <li class="published">
                <i class="icon-time icon-black"></i> On: <strong>May 7, 2009</strong>
            </li>
            <li class="categories">
                <i class="icon-book icon-black"></i> In: <a href="/category/programming/" title="View all posts in Programming" rel="category tag" address="true">Programming</a> </li>
            <li class="comments">
                <i class="icon-comment icon-black"></i> With <a href="/php-class-curl/#respond" title="Comment on New Class: cURL" address="true">no comments</a> </li>
            <li class="tags">
                <i class="icon-tags icon-black"></i> Tags: <a href="/tag/class/" rel="tag" address="true">Class</a>, <a href="/tag/curl/" rel="tag" address="true">cURL</a>, <a href="/tag/php/" rel="tag" address="true">PHP</a> </li>
        </ul>
    </div>
    <div class="post-thumb">
        <a title="Permanent Link to New Class: cURL" href="/php-class-curl/" address="true"></a>
    </div>
    <div class="span9 content">
        <p><span id="more-805"></span>
        </p>
        <p>Here’s a quick release. I’ve been doing a lot of scraping work lately and of course use a&nbsp;<a href="http://curl.haxx.se/" target="_blank">cURL</a>&nbsp;class. There’s plenty of&nbsp;<a href="http://curl.haxx.se/" target="_blank">cURL</a>&nbsp;classes out there, and here’s another. I plan on evolving the class (joining multicurl into curl) and taking advantage of&nbsp;<a href="http://php.net/" target="_blank">PHP</a>&nbsp;5.3 lambdas.</p>
        <pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pun">&lt;?</span><span class="pln">php</span><p></p></li><li class="L3"><p><span class="pln">require_once</span><span class="pun">(</span><span class="str">"../src/curl.php"</span><span class="pun">);</span></p></li><li class="L4"><p><span class="pln">$session </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> curl</span><span class="pun">();</span></p></li><li class="L5"><p><span class="pln">$m1 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> curl_request</span><span class="pun">();</span></p></li><li class="L6"><p></p></li><li class="L7"><p><span class="pln">$m1</span><span class="pun">-&gt;</span><span class="pln">set_url</span><span class="pun">(</span><span class="str">"http://google.com/"</span><span class="pun">);</span></p></li><li class="L8"><p><span class="pln">$r1 </span><span class="pun">=</span><span class="pln"> $session</span><span class="pun">-&gt;</span><span class="pln">run</span><span class="pun">(</span><span class="pln">$m1</span><span class="pun">);</span><span class="pln"> </span><span class="com">// returns a curl_response object</span></p></li><li class="L9"><p><span class="pln">echo $r1</span><span class="pun">-&gt;</span><span class="pln">status_code</span><span class="pun">;</span></p></li><li class="L0"><p><span class="pun">?&gt;</span></p></li><li class="L1"><p></p></li></ol></pre>
        <p>&nbsp;</p>
        <p><strong>[Mar 8, 2010]</strong>&nbsp;I’ve merged multicurl into the curl class. Now if you specify a callback it will assume you want asynchronous results, if you don’t it will return the results synchronously as normal. I’ve also added the curl_request/curl_response classes which wrap common functionality. I added an example of multicurl downloading multiple pages at once. This example also uses PHP 5.3 lambda’s, but isn’t required (defaults to call_user_func_array in versions below 5.3).</p>
        <pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pun">&lt;?</span><span class="pln">php</span><p></p></li><li class="L3"><p><span class="pln">require_once</span><span class="pun">(</span><span class="str">"../src/curl.php"</span><span class="pun">);</span></p></li><li class="L4"><p><span class="pln">$session </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> curl</span><span class="pun">();</span></p></li><li class="L5"><p><span class="pln">$m1 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> curl_request</span><span class="pun">();</span></p></li><li class="L6"><p></p></li><li class="L7"><p><span class="pln">$m1</span><span class="pun">-&gt;</span><span class="pln">set_url</span><span class="pun">(</span><span class="str">"http://www.youtube.com/"</span><span class="pun">);</span></p></li><li class="L8"><p><span class="pln">$session</span><span class="pun">-&gt;</span><span class="pln">run</span><span class="pun">(</span><span class="pln">$m1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">$r1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">use</span><span class="pun">(&amp;</span><span class="pln">$session</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">$m1</span><span class="pun">)</span></p></li><li class="L9"><p></p></li><li class="L0"><p><span class="pun">{</span></p></li><li class="L1"><p></p></li><li class="L2"><p><span class="pln">	</span><span class="kwd">print</span><span class="pln"> </span><span class="str">"[youtube] Loaded home page.\n"</span><span class="pun">;</span></p></li><li class="L3"><p><span class="pln">	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">$i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> $i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">$i</span><span class="pun">)</span></p></li><li class="L4"><p></p></li><li class="L5"><p><span class="pln">	</span><span class="pun">{</span></p></li><li class="L6"><p></p></li><li class="L7"><p><span class="pln">		$m1</span><span class="pun">-&gt;</span><span class="pln">set_url</span><span class="pun">(</span><span class="str">"http://www.youtube.com/videos?p="</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> $i</span><span class="pun">);</span></p></li><li class="L8"><p><span class="pln">		$session</span><span class="pun">-&gt;</span><span class="pln">run</span><span class="pun">(</span><span class="pln">$m1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">$r1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">use</span><span class="pun">(</span><span class="pln">$i</span><span class="pun">)</span></p></li><li class="L9"><p></p></li><li class="L0"><p><span class="pln">		</span><span class="pun">{</span></p></li><li class="L1"><p></p></li><li class="L2"><p><span class="pln">			</span><span class="kwd">print</span><span class="pln"> </span><span class="str">"[youtube] Loaded video page {$i} ({$r1-&gt;status_code}).\n"</span><span class="pun">;</span></p></li><li class="L3"><p></p></li><li class="L4"><p><span class="pln">		</span><span class="pun">});</span></p></li><li class="L5"><p></p></li><li class="L6"><p><span class="pln">	</span><span class="pun">}</span></p></li><li class="L7"><p></p></li><li class="L8"><p><span class="pun">});</span></p></li><li class="L9"><p><span class="kwd">while</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">)</span></p></li><li class="L0"><p></p></li><li class="L1"><p><span class="pun">{</span></p></li><li class="L2"><p></p></li><li class="L3"><p><span class="pln">	$session</span><span class="pun">-&gt;</span><span class="pln">update</span><span class="pun">();</span></p></li><li class="L4"><p></p></li><li class="L5"><p><span class="pln">	echo </span><span class="str">"."</span><span class="pun">;</span><span class="pln"> </span><span class="com">// debug</span></p></li><li class="L6"><p></p></li><li class="L7"><p><span class="pln">	usleep</span><span class="pun">(</span><span class="lit">20000</span><span class="pun">);</span></p></li><li class="L8"><p></p></li><li class="L9"><p><span class="pun">}</span></p></li><li class="L0"><p><span class="pun">?&gt;</span></p></li><li class="L1"><p></p></li></ol></pre>
        <p>&nbsp;</p>
        <p><strong>Links:</strong>
        </p>
        <ul>
            <li><a href="http://github.com/ericmuyser/php-class-curl/" target="_blank"><em>PHP cURL Class</em>&nbsp;Source</a>
            </li>
            <li><a href="http://github.com/downloads/ericmuyser/php-class-curl/zipball/master" target="_blank"><em>PHP cURL Class</em>&nbsp;Download</a>
            </li>
        </ul>
        <p>&nbsp;</p>
        <p>More found on the&nbsp;<a href="/work/" address="true">work</a>&nbsp;page, and more to come!</p>
    </div>
</div>
<ul class="pager">
    <li class="previous">
        <a href="/bnetdb/" rel="prev" address="true">← New Website: Battle.net Database</a> </li>
    <li class="next">
        <a href="/php-class-lambda/" rel="next" address="true">New Class: Lambda →</a> </li>
</ul>
